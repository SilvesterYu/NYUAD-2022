global phase: π
               ┌─────────┐ ┌────┐┌──────────┐┌───┐┌──────────┐┌───┐┌─────────┐            ┌───┐                                                     ┌──────────┐┌────┐┌─────────┐                                                                                         ┌─────────┐           ┌───┐     ┌──────────┐   ┌────┐   ┌──────────┐                              ░       ┌─┐
      q_2 -> 0 ┤ Rz(π/2) ├─┤ √X ├┤ Rz(3π/4) ├┤ X ├┤ Rz(-π/4) ├┤ X ├┤ Rz(π/4) ├─────■──────┤ X ├──■───────────────────────────────────────────■──────┤ Rz(-π/2) ├┤ √X ├┤ Rz(π/2) ├─────────────────────────────────────────────────────■────────────────────────────────■──┤ Rz(π/4) ├────────■──┤ X ├──■──┤ Rz(3π/4) ├───┤ √X ├───┤ Rz(-π/2) ├──────────────────────────────░───────┤M├
               ├─────────┤ ├────┤├──────────┤└─┬─┘└──────────┘└─┬─┘└─────────┘   ┌─┴─┐    └─┬─┘┌─┴─┐┌───┐┌─────────┐┌───┐     ┌───┐        ┌─┴─┐    ├─────────┬┘└────┘└─────────┘      ┌──────────┐┌────┐┌──────────┐     ┌───┐     ┌─┴─┐┌──────────┐┌───┐┌─────────┐┌─┴─┐├─────────┴┐┌───┐┌─┴─┐└─┬─┘┌─┴─┐└──┬───┬───┘┌──┴────┴──┐└──┬───┬───┘┌─────────┐┌────┐┌──────────┐ ░    ┌─┐└╥┘
      q_1 -> 1 ┤ Rz(π/2) ├─┤ √X ├┤ Rz(3π/4) ├──■────────────────■───────■────────┤ X ├──────■──┤ X ├┤ X ├┤ Rz(π/4) ├┤ X ├──■──┤ X ├──■─────┤ X ├────┤ Rz(π/4) ├───■─────────────────■──┤ Rz(-π/2) ├┤ √X ├┤ Rz(-π/2) ├──■──┤ X ├──■──┤ X ├┤ Rz(-π/4) ├┤ X ├┤ Rz(π/4) ├┤ X ├┤ Rz(-π/4) ├┤ X ├┤ X ├──■──┤ X ├───┤ X ├────┤ Rz(-π/4) ├───┤ X ├────┤ Rz(π/2) ├┤ √X ├┤ Rz(-π/2) ├─░────┤M├─╫─
               ├─────────┴┐├────┤├─────────┬┘                         ┌─┴─┐   ┌──┴───┴───┐     └───┘└─┬─┘└─────────┘└─┬─┘┌─┴─┐└─┬─┘┌─┴─┐┌──┴───┴───┐└─────────┘ ┌─┴─┐ ┌──────────┐┌─┴─┐├─────────┬┘├────┤├─────────┬┘┌─┴─┐└─┬─┘┌─┴─┐└───┘└──────────┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘└───┘     └───┘   └─┬─┘    ├─────────┬┘   └─┬─┘    ├─────────┤├────┤├──────────┤ ░ ┌─┐└╥┘ ║ 
      q_0 -> 2 ┤ Rz(-π/2) ├┤ √X ├┤ Rz(π/2) ├──────────────────────────┤ X ├───┤ Rz(-π/4) ├────────────■───────────────■──┤ X ├──■──┤ X ├┤ Rz(-π/4) ├────────────┤ X ├─┤ Rz(-π/4) ├┤ X ├┤ Rz(π/2) ├─┤ √X ├┤ Rz(π/2) ├─┤ X ├──■──┤ X ├───────────────────■────────────────────────────────■──────────────────────■──────┤ Rz(π/4) ├──────■──────┤ Rz(π/2) ├┤ √X ├┤ Rz(-π/2) ├─░─┤M├─╫──╫─
               └──────────┘└────┘└─────────┘                          └───┘   └──────────┘                               └───┘     └───┘└──────────┘            └───┘ └──────────┘└───┘└─────────┘ └────┘└─────────┘ └───┘     └───┘                                                                                  └─────────┘             └─────────┘└────┘└──────────┘ ░ └╥┘ ║  ║ 
ancilla_0 -> 3 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────░──╫──╫──╫─
                                                                                                                                                                                                                                                                                                                                                                            ░  ║  ║  ║ 
ancilla_1 -> 4 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────░──╫──╫──╫─
                                                                                                                                                                                                                                                                                                                                                                            ░  ║  ║  ║ 
       meas: 3/════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╩══╩══╩═
                                                                                                                                                                                                                                                                                                                                                                               0  1  2 